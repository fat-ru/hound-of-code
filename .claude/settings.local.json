{
  "permissions": {
    "allow": [
      "Bash(npm run build)",
      "mcp__ide__getDiagnostics",
      "Bash(go build ./...)",
      "Bash(npx webpack:*)",
      "Bash(npm install)",
      "Bash(make:*)",
      "Bash(go build:*)",
      "Bash(curl:*)",
      "Bash(dir:*)",
      "Bash(findstr:*)",
      "Bash(base64:*)",
      "Bash(python -c:*)",
      "Bash(identify \"D:/Project/OpenSourceTool/hound/screenshot.png\")",
      "Bash(powershell -Command \"\\(Get-Content ''D:/Project/OpenSourceTool/hound/cmds/houndd/main.go'' | ForEach-Object {$_-replace ''info_log.Println\\\\\\(\"\"Using JWT secret from config file\"\"\\)'', ''info_log.Printf\\(\"\"Using JWT secret from config file \\(length: %d\\)\"\", len\\($jwtSecret\\)\\)''} | Set-Content ''D:/Project/OpenSourceTool/hound/cmds/houndd/main.go''\")",
      "Bash(ls:*)",
      "Bash(sqlite3:*)",
      "Bash(git checkout:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(go vet:*)",
      "Bash(set GOPROXY=https://goproxy.cn,direct:*)",
      "Bash(go env GOPROXY:*)",
      "Bash(go env GOMODULECACHE)",
      "Bash(set GOPROXY=https://goproxy.cn)",
      "Bash(go env:*)",
      "Bash(grep:*)",
      "Bash(\"D:\\\\Project\\\\OpenSourceTool\\\\hound\\\\ui\\\\assets\\\\js\\\\user-settings.js\" << 'ENDOFFILE'\n/**\n * User Settings Page Module\n */\nvar UserSettings = \\(function\\(\\) {\n    var container;\n    var users = [];\n\n    function init\\(el\\) {\n        container = el;\n        loadUsers\\(\\);\n    }\n\n    function loadUsers\\(\\) {\n        console.log\\('[UserSettings] Loading users...'\\);\n\n        Auth.getUsers\\(\\)\n            .then\\(function\\(data\\) {\n                console.log\\('[UserSettings] Users loaded:', data\\);\n                // Handle different response formats\n                if \\(!data\\) {\n                    data = {};\n                }\n                // Check if data itself is the users array or contains a users property\n                if \\(Array.isArray\\(data\\)\\) {\n                    users = data;\n                } else if \\(Array.isArray\\(data.users\\)\\) {\n                    users = data.users;\n                } else {\n                    users = [];\n                }\n\n                if \\(!Array.isArray\\(users\\)\\) {\n                    console.error\\('[UserSettings] Users is not an array:', users\\);\n                    users = [];\n                }\n\n                // Filter out invalid user objects\n                users = users.filter\\(function\\(user\\) {\n                    return user && typeof user === 'object' && \\(user.username || user.id\\);\n                }\\);\n\n                render\\(\\);\n            }\\)\n            .catch\\(function\\(err\\) {\n                console.error\\('[UserSettings] Failed to load users:', err\\);\n                container.innerHTML = '<div class=\"error\">Failed to load users: ' + err.message + '</div>';\n            }\\);\n    }\n\n    function render\\(\\) {\n        console.log\\('[UserSettings] Rendering users, count:', users.length\\);\n\n        var htmlParts = [];\n        htmlParts.push\\('<div class=\"toolbar\">'\\);\n        htmlParts.push\\('  <div class=\"search-box\">'\\);\n        htmlParts.push\\('    <input type=\"text\" id=\"userSearch\" placeholder=\"Search users...\" autocomplete=\"off\">'\\);\n        htmlParts.push\\('  </div>'\\);\n        htmlParts.push\\('  <button class=\"btn-primary\" id=\"addUserBtn\">Add User</button>'\\);\n        htmlParts.push\\('</div>'\\);\n        htmlParts.push\\('<table class=\"data-table\">'\\);\n        htmlParts.push\\('  <thead>'\\);\n        htmlParts.push\\('    <tr>'\\);\n        htmlParts.push\\('      <th>ID</th>'\\);\n        htmlParts.push\\('      <th>Username</th>'\\);\n        htmlParts.push\\('      <th>Role</th>'\\);\n        htmlParts.push\\('      <th>Created At</th>'\\);\n        htmlParts.push\\('      <th>Actions</th>'\\);\n        htmlParts.push\\('    </tr>'\\);\n        htmlParts.push\\('  </thead>'\\);\n        htmlParts.push\\('  <tbody id=\"userList\"></tbody>'\\);\n        htmlParts.push\\('</table>'\\);\n        htmlParts.push\\('<div id=\"userModal\"></div>'\\);\n\n        container.innerHTML = htmlParts.join\\(''\\);\n\n        var tbody = document.getElementById\\('userList'\\);\n        if \\(!users || users.length === 0\\) {\n            tbody.innerHTML = '<tr><td colspan=\"5\" class=\"empty-state\">No users found</td></tr>';\n        } else {\n            tbody.innerHTML = users.map\\(function\\(user\\) {\n                var badgeClass = 'badge-success';\n                if \\(user.role === 'owner'\\) badgeClass = 'badge-danger';\n                else if \\(user.role === 'admin'\\) badgeClass = 'badge-info';\n                return '<tr>' +\n                    '<td>' + \\(user.id || ''\\) + '</td>' +\n                    '<td>' + escapeHtml\\(user.username\\) + '</td>' +\n                    '<td><span class=\"badge ' + badgeClass + '\">' + escapeHtml\\(user.role\\) + '</span></td>' +\n                    '<td>' + formatDate\\(user.createdAt\\) + '</td>' +\n                    '<td class=\"actions\">' +\n                    '  <button class=\"btn-edit\" data-id=\"' + user.id + '\">Edit</button>' +\n                    '  <button class=\"btn-delete\" data-id=\"' + user.id + '\">Delete</button>' +\n                    '</td>' +\n                    '</tr>';\n            }\\).join\\(''\\);\n        }\n\n        setupEventListeners\\(\\);\n    }\n\n    function setupEventListeners\\(\\) {\n        var searchInput = document.getElementById\\('userSearch'\\);\n        if \\(searchInput\\) {\n            searchInput.addEventListener\\('input', function\\(e\\) {\n                filterUsers\\(e.target.value\\);\n            }\\);\n        }\n\n        container.addEventListener\\('click', function\\(e\\) {\n            var target = e.target;\n            if \\(target.classList.contains\\('btn-edit'\\)\\) {\n                var id = parseInt\\(target.getAttribute\\('data-id'\\)\\);\n                var user = users.find\\(function\\(u\\) { return u.id === id; }\\);\n                if \\(user\\) {\n                    showUserModal\\(user\\);\n                }\n            } else if \\(target.classList.contains\\('btn-delete'\\)\\) {\n                var id = parseInt\\(target.getAttribute\\('data-id'\\)\\);\n                if \\(confirm\\('Are you sure you want to delete this user?'\\)\\) {\n                    deleteUser\\(id\\);\n                }\n            }\n        }\\);\n    }\n\n    function filterUsers\\(query\\) {\n        if \\(!users || !Array.isArray\\(users\\)\\) {\n            return;\n        }\n\n        var filtered = users.filter\\(function\\(user\\) {\n            var username = user.username || '';\n            var role = user.role || '';\n            return username.toLowerCase\\(\\).indexOf\\(query.toLowerCase\\(\\)\\) !== -1 ||\n                role.toLowerCase\\(\\).indexOf\\(query.toLowerCase\\(\\)\\) !== -1;\n        }\\);\n\n        var tbody = document.getElementById\\('userList'\\);\n        if \\(filtered.length === 0\\) {\n            tbody.innerHTML = '<tr><td colspan=\"5\" class=\"empty-state\">No matching users</td></tr>';\n        } else {\n            tbody.innerHTML = filtered.map\\(function\\(user\\) {\n                var badgeClass = 'badge-success';\n                if \\(user.role === 'owner'\\) badgeClass = 'badge-danger';\n                else if \\(user.role === 'admin'\\) badgeClass = 'badge-info';\n                return '<tr>' +\n                    '<td>' + \\(user.id || ''\\) + '</td>' +\n                    '<td>' + escapeHtml\\(user.username\\) + '</td>' +\n                    '<td><span class=\"badge ' + badgeClass + '\">' + escapeHtml\\(user.role\\) + '</span></td>' +\n                    '<td>' + formatDate\\(user.createdAt\\) + '</td>' +\n                    '<td class=\"actions\">' +\n                    '  <button class=\"btn-edit\" data-id=\"' + user.id + '\">Edit</button>' +\n                    '  <button class=\"btn-delete\" data-id=\"' + user.id + '\">Delete</button>' +\n                    '</td>' +\n                    '</tr>';\n            }\\).join\\(''\\);\n        }\n    }\n\n    function showUserModal\\(user\\) {\n        var isEdit = !!user;\n        var modalHtmlParts = [];\n        modalHtmlParts.push\\('<div class=\"modal-overlay\">'\\);\n        modalHtmlParts.push\\('  <div class=\"modal\">'\\);\n        modalHtmlParts.push\\('    <h2>' + \\(isEdit ? 'Edit User' : 'Add User'\\) + '</h2>'\\);\n        modalHtmlParts.push\\('    <div id=\"userFormMessage\"></div>'\\);\n        modalHtmlParts.push\\('    <form id=\"userForm\">'\\);\n        modalHtmlParts.push\\('      <input type=\"hidden\" name=\"id\" value=\"' + \\(user ? user.id : ''\\) + '\">'\\);\n        modalHtmlParts.push\\('      <div class=\"form-group\">'\\);\n        modalHtmlParts.push\\('        <label for=\"username\">Username</label>'\\);\n        modalHtmlParts.push\\('        <input type=\"text\" id=\"username\" name=\"username\" value=\"' + \\(user ? escapeHtml\\(user.username\\) : ''\\) + '\" required minlength=\"3\">'\\);\n        modalHtmlParts.push\\('      </div>'\\);\n        modalHtmlParts.push\\('      <div class=\"form-group\">'\\);\n        modalHtmlParts.push\\('        <label for=\"password\">Password' + \\(isEdit ? ' \\(leave blank to keep current\\)' : ''\\) + '</label>'\\);\n        modalHtmlParts.push\\('        <input type=\"password\" id=\"password\" name=\"password\" ' + \\(isEdit ? '' : 'required'\\) + ' minlength=\"6\">'\\);\n        modalHtmlParts.push\\('      </div>'\\);\n        modalHtmlParts.push\\('      <div class=\"form-group\">'\\);\n        modalHtmlParts.push\\('        <label for=\"role\">Role</label>'\\);\n        modalHtmlParts.push\\('        <select id=\"role\" name=\"role\">'\\);\n        modalHtmlParts.push\\('          <option value=\"member\"' + \\(user && user.role === 'member' ? ' selected' : ''\\) + '>Member</option>'\\);\n        modalHtmlParts.push\\('          <option value=\"admin\"' + \\(user && user.role === 'admin' ? ' selected' : ''\\) + '>Admin</option>'\\);\n        modalHtmlParts.push\\('        </select>'\\);\n        modalHtmlParts.push\\('      </div>'\\);\n        modalHtmlParts.push\\('      <div class=\"modal-footer\">'\\);\n        modalHtmlParts.push\\('        <button type=\"button\" class=\"btn-cancel\" id=\"cancelUserBtn\">Cancel</button>'\\);\n        modalHtmlParts.push\\('        <button type=\"submit\" class=\"btn-primary\">' + \\(isEdit ? 'Update' : 'Create'\\) + '</button>'\\);\n        modalHtmlParts.push\\('      </div>'\\);\n        modalHtmlParts.push\\('    </form>'\\);\n        modalHtmlParts.push\\('  </div>'\\);\n        modalHtmlParts.push\\('</div>'\\);\n\n        var modalContainer = document.getElementById\\('userModal'\\);\n        modalContainer.innerHTML = modalHtmlParts.join\\(''\\);\n\n        var form = document.getElementById\\('userForm'\\);\n        var messageDiv = document.getElementById\\('userFormMessage'\\);\n\n        document.getElementById\\('cancelUserBtn'\\).addEventListener\\('click', function\\(\\) {\n            modalContainer.innerHTML = '';\n        }\\);\n\n        form.addEventListener\\('submit', function\\(e\\) {\n            e.preventDefault\\(\\);\n\n            var formData = {\n                username: document.getElementById\\('username'\\).value,\n                role: document.getElementById\\('role'\\).value\n            };\n\n            var password = document.getElementById\\('password'\\).value;\n            if \\(password\\) {\n                formData.password = password;\n            }\n\n            var promise;\n            if \\(isEdit\\) {\n                promise = Auth.updateUser\\(user.id, formData\\);\n            } else {\n                promise = Auth.createUser\\(formData.username, password || formData.password, formData.role\\);\n            }\n\n            promise\n                .then\\(function\\(\\) {\n                    modalContainer.innerHTML = '';\n                    loadUsers\\(\\);\n                }\\)\n                .catch\\(function\\(err\\) {\n                    messageDiv.innerHTML = '<div class=\"error\">' + err.message + '</div>';\n                }\\);\n        }\\);\n    }\n\n    function deleteUser\\(id\\) {\n        Auth.deleteUser\\(id\\)\n            .then\\(function\\(\\) {\n                loadUsers\\(\\);\n            }\\)\n            .catch\\(function\\(err\\) {\n                alert\\('Failed to delete user: ' + err.message\\);\n            }\\);\n    }\n\n    function escapeHtml\\(text\\) {\n        if \\(!text\\) return '';\n        var div = document.createElement\\('div'\\);\n        div.textContent = text;\n        return div.innerHTML;\n    }\n\n    function formatDate\\(dateStr\\) {\n        if \\(!dateStr\\) return '-';\n        try {\n            var date = new Date\\(dateStr\\);\n            return date.toLocaleDateString\\(\\) + ' ' + date.toLocaleTimeString\\(\\);\n        } catch \\(e\\) {\n            return dateStr;\n        }\n    }\n\n    return {\n        init: init\n    };\n}\\)\\(\\);\nENDOFFILE)",
      "Bash(\"D:\\\\Project\\\\OpenSourceTool\\\\hound\\\\ui\\\\assets\\\\js\\\\user-settings.js\" << 'EOF'\nvar UserSettings = \\(function\\(\\) {\n    var container;\n    var users = [];\n\n    function init\\(el\\) {\n        container = el;\n        loadUsers\\(\\);\n    }\n\n    function loadUsers\\(\\) {\n        Auth.getUsers\\(\\).then\\(function\\(data\\) {\n            if \\(!data\\) data = {};\n            if \\(Array.isArray\\(data\\)\\) {\n                users = data;\n            } else if \\(Array.isArray\\(data.users\\)\\) {\n                users = data.users;\n            } else {\n                users = [];\n            }\n            users = users.filter\\(function\\(user\\) {\n                return user && user.username;\n            }\\);\n            render\\(\\);\n        }\\).catch\\(function\\(err\\) {\n            container.innerHTML = \"div class=error\" + err.message + \"/div\";\n        }\\);\n    }\n\n    function render\\(\\) {\n        container.innerHTML = [\n            \"div class=toolbar\",\n            \"  div class=search-box\",\n            \"    input type=text id=userSearch placeholder='Search users...'\",\n            \"  /div\",\n            \"  button class=btn-primary id=addUserBtnAdd User/button\",\n            \"/div\",\n            \"table class=data-table\",\n            \"  thead\",\n            \"    tr\",\n            \"      thID/th\",\n            \"      thUsername/th\",\n            \"      thRole/th\",\n            \"      thCreated At/th\",\n            \"      thActions/th\",\n            \"    /tr\",\n            \"  /thead\",\n            \"  tbody id=userList/tbody\",\n            \"/table\",\n            \"div id=userModal/div\"\n        ].join\\(\"\"\\);\n    }\n\n    function setupEventListeners\\(\\) {\n        var searchInput = document.getElementById\\(\"userSearch\"\\);\n        if \\(searchInput\\) {\n            searchInput.addEventListener\\(\"input\", function\\(e\\) {\n                filterUsers\\(e.target.value\\);\n            }\\);\n        }\n    }\n\n    function filterUsers\\(query\\) {\n        var filtered = users.filter\\(function\\(user\\) {\n            return user.username.toLowerCase\\(\\).indexOf\\(query.toLowerCase\\(\\)\\) !== -1;\n        }\\);\n        var tbody = document.getElementById\\(\"userList\"\\);\n        tbody.innerHTML = filtered.map\\(function\\(user\\) {\n            return \"trtd\" + user.id + \"/tdtd\" + user.username + \"/tdtd\" + user.role + \"/td/tr\";\n        }\\).join\\(\"\"\\);\n    }\n\n    return {init:init};\n}\\)\\(\\);\nEOF)"
    ]
  }
}
